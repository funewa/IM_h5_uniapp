import{_ as e,l as t,s as a,u as l,q as s,af as i,L as n,p as c,a6 as d,o,c as u,w as r,g as f,i as g,n as m,t as _,h as b,d as h,F as k,f as x,r as p,j as y,k as I,A as C}from"./index.5cd51b9e.js";const N=t(a),v=l(a);var w=e({data:()=>({modelName:"",detail:{},userInfo:v.userInfo,globalConfig:v.globalConfig}),computed:{validatePhone(){return/^1[3456789]\d{9}$/.test(this.detail.account)}},onLoad(e){this.$api.msgApi.getUserInfo({user_id:e.id}).then((e=>{0==e.code&&(this.detail=e.data)}))},methods:{sendMsg(e){s({url:"/pages/message/chat?id="+e.user_id})},sex:e=>["女","男","未知"][e]||"未知",callPhone(){i({phoneNumber:this.detail.account})},calling(e){if(N.webrtcLock)return n({title:"其他终端正在通话中",icon:"none"});this.modelName="";let t=this.$util.getUuid();s({url:"/pages/message/call?msg_id="+t+"&type="+e+"&status=1&id="+this.detail.user_id+"&name="+this.detail.realname+"&avatar="+encodeURI(this.detail.avatar)})},delFriend(){c({title:"确定要删除该好友吗？",success:e=>{if(e.confirm){let e={id:this.detail.user_id};this.$api.friendApi.delFriend(e).then((t=>{0==t.code&&(N.deleteContacts(e),d({url:"/pages/index/index"}))}))}}})},addFriend(){c({title:"请输入验证信息",editable:!0,success:e=>{if(e.confirm){if(""==e.content)return n({title:"请输入备注！",icon:"error"});this.$api.friendApi.addFriend({user_id:this.detail.user_id,remark:e.content}).then((e=>{0==e.code&&n({title:e.msg,icon:"none"})}))}}})},setNickname(){var e;let t=null!=(e=this.detail.friend.friend_id)?e:"";if(!this.detail.friend)return n({title:"无法设置",icon:"error"});c({title:"请输入备注信息",editable:!0,success:e=>{if(e.confirm){if(""==e.content)return n({title:"请输入好友备注！",icon:"error"});this.$api.friendApi.setNickname({friend_id:t,nickname:e.content}).then((t=>{0==t.code&&(this.detail.friend.nickname=e.content,n({title:t.msg,icon:"none"}))}))}}})}}},[["render",function(e,t,a,l,s,i){const n=p("cu-custom"),c=y,d=I,N=C;return o(),u(c,null,{default:r((()=>[f(n,{bgColor:"bg-white",isBack:!0},{backText:r((()=>[])),content:r((()=>[g("个人信息")])),_:1}),f(c,{class:"padding flex justify-start align-center"},{default:r((()=>[f(c,{class:"cu-avatar lg radius mr-15",style:m("background-image:url("+s.detail.avatar+")")},null,8,["style"]),f(c,{class:"im-flex im-justify-content-start im-columns"},{default:r((()=>[f(c,{class:"mb-5"},{default:r((()=>[g(_(s.detail.realname),1)])),_:1}),f(c,{class:"text-gray"},{default:r((()=>[g(_(s.detail.account),1)])),_:1})])),_:1})])),_:1}),f(c,{class:"cu-list menu"},{default:r((()=>[2==s.globalConfig.sysInfo.runMode&&s.detail.friend&&s.userInfo.user_id!=s.detail.user_id?(o(),u(c,{key:0,class:"cu-item",onClick:i.setNickname},{default:r((()=>[f(c,{class:"content"},{default:r((()=>[f(d,{class:"cuIcon-edit text-green"}),f(d,null,{default:r((()=>[g("备注")])),_:1})])),_:1}),f(c,{class:"action"},{default:r((()=>[f(d,{class:"text-grey text-sm"},{default:r((()=>[g(_(s.detail.friend.nickname||"未设置"),1)])),_:1}),f(d,{class:"text-grey text-sm ml-5 cuIcon-write"})])),_:1})])),_:1},8,["onClick"])):b("",!0),f(c,{class:"cu-item"},{default:r((()=>[f(c,{class:"content"},{default:r((()=>[f(d,{class:"cuIcon-mail text-green"}),f(d,null,{default:r((()=>[g("邮箱")])),_:1})])),_:1}),f(c,{class:"action"},{default:r((()=>[f(d,{class:"text-grey text-sm"},{default:r((()=>{var e;return[g(_(null!=(e=s.detail.email)?e:"raingad@foxmail.com"),1)]})),_:1})])),_:1})])),_:1}),f(c,{class:"cu-item"},{default:r((()=>[f(c,{class:"content"},{default:r((()=>[f(d,{class:"cuIcon-safe text-green"}),f(d,null,{default:r((()=>[g("性别")])),_:1})])),_:1}),f(c,{class:"action"},{default:r((()=>[f(d,{class:"text-grey text-sm"},{default:r((()=>[g(_(i.sex(s.detail.sex)),1)])),_:1})])),_:1})])),_:1}),parseInt(s.globalConfig.sysInfo.ipregion)?(o(),u(c,{key:1,class:"cu-item"},{default:r((()=>[f(c,{class:"content"},{default:r((()=>[f(d,{class:"cuIcon-location text-green"}),f(d,null,{default:r((()=>[g("IP")])),_:1})])),_:1}),f(c,{class:"action"},{default:r((()=>[s.detail.last_login_ip?(o(),u(d,{key:0,class:"text-grey text-sm"},{default:r((()=>[g(_(s.detail.last_login_ip||"未知")+" （"+_(s.detail.location||"未知")+"）",1)])),_:1})):(o(),u(d,{key:1,class:"text-grey text-sm"},{default:r((()=>[g("未知")])),_:1}))])),_:1})])),_:1})):b("",!0)])),_:1}),s.userInfo.user_id!=s.detail.user_id?(o(),h(k,{key:0},[1==s.globalConfig.sysInfo.runMode||s.detail.friend?(o(),u(c,{key:0,class:"padding flex flex-direction"},{default:r((()=>[f(N,{class:"cu-btn bg-green mt-10 lg",onClick:t[0]||(t[0]=e=>i.sendMsg(s.detail))},{default:r((()=>[g("发消息")])),_:1}),i.validatePhone?(o(),u(N,{key:0,class:"cu-btn bg-blue mt-10 lg",onClick:t[1]||(t[1]=e=>i.callPhone())},{default:r((()=>[g("打电话")])),_:1})):b("",!0),parseInt(s.globalConfig.chatInfo.webrtc)?(o(),u(N,{key:1,class:"cu-btn bg-grey mt-10 lg",onClick:t[2]||(t[2]=e=>s.modelName="callRtc")},{default:r((()=>[g("音视频通话")])),_:1})):b("",!0),2==s.globalConfig.sysInfo.runMode?(o(),u(N,{key:2,class:"cu-btn bg-red mt-10 lg",onClick:t[3]||(t[3]=e=>i.delFriend())},{default:r((()=>[g("删除好友")])),_:1})):b("",!0)])),_:1})):b("",!0),2!=s.globalConfig.sysInfo.runMode||s.detail.friend?b("",!0):(o(),u(c,{key:1,class:"padding flex flex-direction"},{default:r((()=>[f(N,{class:"cu-btn bg-green lg",onClick:t[4]||(t[4]=e=>i.addFriend())},{default:r((()=>[g("加好友")])),_:1})])),_:1}))],64)):b("",!0),f(c,{class:x(["cu-modal bottom-modal","callRtc"==s.modelName?"show":""]),onClick:t[8]||(t[8]=e=>s.modelName="")},{default:r((()=>[f(c,{class:"cu-dialog"},{default:r((()=>[f(c,{class:"manage-content"},{default:r((()=>[f(c,{class:"cu-list menu bg-white"},{default:r((()=>[f(c,{class:"cu-item",onClick:t[5]||(t[5]=e=>i.calling(0))},{default:r((()=>[f(c,{class:"content padding-tb-sm"},{default:r((()=>[f(d,{class:"cuIcon-dianhua"}),f(d,null,{default:r((()=>[g("语音通话")])),_:1})])),_:1})])),_:1}),f(c,{class:"cu-item",onClick:t[6]||(t[6]=e=>i.calling(1))},{default:r((()=>[f(c,{class:"content padding-tb-sm"},{default:r((()=>[f(d,{class:"cuIcon-record"}),f(d,null,{default:r((()=>[g("视频通话")])),_:1})])),_:1})])),_:1}),f(c,{class:"parting-line-5"}),f(c,{class:"cu-item",onClick:t[7]||(t[7]=e=>s.modelName="")},{default:r((()=>[f(c,{class:"content padding-tb-sm"},{default:r((()=>[f(d,{class:"c-red"},{default:r((()=>[g("取消")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})}]]);export{w as default};
